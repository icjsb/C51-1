C51 COMPILER V9.00   DD                                                                    04/16/2015 18:28:55 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE DD
OBJECT MODULE PLACED IN dd.OBJ
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE dd.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1                                  #include <reg51.h>
   2          
   3          #define LCDLCDDisp_Off   0x3e
   4          #define LCDLCDDisp_On    0x3f
   5          #define Page_Add     0xb8//ye
   6          
   7          #define LCDCol_Add     0x40//lie
   8          #define Start_Line     0xC0//hang
   9          /*****液晶显示器的端口定义*****/
  10          #define data_ora P1 /*液晶数据总线*/
  11          sbit LCDMcs=P2^4 ;    /*片选1*/
  12          sbit LCDScs=P2^3 ;    /*片选2*/
  13          sbit LCDDi=P2^2 ;     /*数据/指令 选择*/
  14          sbit LCDRW=P2^1 ;     /*读/写 选择*/
  15          sbit LCDEnable=P2^0 ;     /*读/写 使能*/
  16          
  17          
  18          
  19          char code Hz[]=
  20          {
  21          /*------------------------------------------------------------------------------
  22            源文件 / 文字 : F:\LD测试仪\液晶\字模提取+排版软件\液晶字模提取\图例\yema.bmp萍
  23            宽×高（像素）: 128×64
  24            字模格式/大小 : 单色点阵液晶字模，纵向取模，字节倒序/1024字节
  25            数据转换日期  : 2010-7-29 9:09:37
  26          ------------------------------------------------------------------------------*/
  27          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  28          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  29          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  30          0x00,0x00,0x00,0x00,0x80,0x90,0xD0,0x78,0xF8,0xF8,0xF8,0xF0,0xF0,0xF0,0xE0,0xE0,
  31          0xE0,0xA0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  32          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  33          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  34          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  35          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  36          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  37          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  38          0x06,0x0F,0x0F,0x07,0x0F,0x0F,0x0F,0xCF,0xFF,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  39          0xFF,0xFF,0xDD,0x9F,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  40          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  41          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  42          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  43          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  44          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  45          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0xF0,0x78,0xF8,0xF0,0xE0,0xC0,0xC0,0x80,
  46          0xC0,0xE0,0xE0,0xF0,0xFC,0xFE,0xFF,0xFF,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  47          0xFF,0xFD,0x3B,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x40,0x20,0x80,
  48          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  49          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  50          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  51          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  52          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  53          0x00,0x00,0x00,0x00,0x00,0xF8,0xFF,0xFF,0xFC,0x9C,0x3C,0x3D,0x3F,0x7F,0xFD,0xFF,
  54          0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF9,0xE1,0xC3,0x87,
  55          0x05,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0xFF,0xFE,0xE3,0xF1,
C51 COMPILER V9.00   DD                                                                    04/16/2015 18:28:55 PAGE 2   

  56          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  57          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  58          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  59          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  60          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  61          0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x01,0x1F,0x1F,0x78,0xF0,0x00,0x00,0x00,0x01,
  62          0x01,0x03,0x07,0x0F,0x1F,0x3F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  63          0xFF,0xFE,0xFE,0xFC,0xF8,0xF0,0xE0,0x80,0x80,0x80,0xC0,0xE0,0xFF,0xDF,0x7F,0x1F,
  64          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  65          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  66          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  67          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  68          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  69          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  70          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x1F,0x7F,0xFF,0xFF,0xEF,0xFF,0xFF,0xFF,
  71          0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,0x1F,0x07,0xBF,0xFF,0x3F,0x1F,0x05,0x00,0x00,0x00,
  72          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  73          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  74          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  75          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  76          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  77          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,
  78          0x07,0x07,0x07,0x07,0x06,0x06,0x06,0x06,0x0E,0x0E,0x0E,0x1F,0x1F,0x07,0x9F,0xFF,
  79          0xFF,0x7B,0x61,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  80          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  81          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  82          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  83          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  84          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  85          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  86          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x18,0x18,0x1C,0x1E,0x07,0x03,0x01,
  87          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  88          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  89          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  90          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
  91          };
  92          
  93          /****************************************************************************
  94          函数功能:LCD延时程序
  95          入口参数:t
  96          出口参数:
  97          ****************************************************************************/
  98          void LCDdelay(unsigned int t)
  99          {
 100   1              unsigned int i,j;
 101   1              for(i=0;i<t;i++);
 102   1              for(j=0;j<10;j++);
 103   1      }
 104          /****************************************************************************
 105          状态检查，LCD是否忙
 106          
 107          
 108          *****************************************************************************/
 109          void CheckState()               
 110          {
 111   1         unsigned char dat,DATA;//状态信息（判断是否忙）
 112   1         LCDDi=0; // 数据\指令选择，D/I（RS）="L" ，表示 DB7∽DB0 为显示指令数据 
 113   1         LCDRW=1; //R/W="H" ，E="H"数据被读到DB7∽DB0 
 114   1         do
 115   1         {
 116   2            DATA=0x00;
 117   2            LCDEnable=1;      //EN下降源
C51 COMPILER V9.00   DD                                                                    04/16/2015 18:28:55 PAGE 3   

 118   2                LCDdelay(2);//延时
 119   2                dat=DATA;
 120   2            LCDEnable=0;
 121   2            dat=0x80 & dat; //仅当第7位为0时才可操作(判别busy信号)
 122   2          }
 123   1          while(!(dat==0x00));
 124   1      }
 125          /*****************************************************************************
 126          函数功能:写命令到LCD程序，RS(DI)=L,RW=L,EN=H，即来一个脉冲写一次
 127          入口参数:cmdcode
 128          出口参数:
 129          *****************************************************************************/
 130          void write_com(unsigned char cmdcode)
 131          {
 132   1          CheckState();//检测LCD是否忙
 133   1              LCDDi=0;
 134   1              LCDRW=0;
 135   1              P1=cmdcode;             
 136   1              LCDdelay(2);
 137   1              LCDEnable=1;
 138   1              LCDdelay(2);
 139   1              LCDEnable=0;
 140   1      }
 141          /*****************************************************************************
 142          函数功能:LCD初始化程序
 143          入口参数:
 144          出口参数:
 145          *****************************************************************************/
 146          void init_lcd()
 147          {
 148   1              LCDdelay(100);  
 149   1              LCDMcs=1;//刚开始关闭两屏
 150   1              LCDScs=1;
 151   1              LCDdelay(100);
 152   1              write_com(LCDLCDDisp_Off);       //写初始化命令
 153   1              write_com(Page_Add+0);
 154   1              write_com(Start_Line+0);
 155   1              write_com(LCDCol_Add+0);
 156   1              write_com(LCDLCDDisp_On);
 157   1      }
 158          /*****************************************************************************
 159          函数功能:写数据到LCD程序，RS(DI)=H,RW=L,EN=H，即来一个脉冲写一次
 160          入口参数:LCDDispdata
 161          出口参数:
 162          *****************************************************************************/
 163          void write_data(unsigned char LCDDispdata)
 164          {
 165   1          CheckState();//检测LCD是否忙
 166   1              LCDDi=1;
 167   1              LCDRW=0;
 168   1              P1=LCDDispdata;
 169   1              LCDdelay(2);
 170   1              LCDEnable=1;
 171   1              LCDdelay(2);
 172   1              LCDEnable=0;
 173   1      }
 174          /*****************************************************************************
 175          函数功能:清除LCD内存程序
 176          入口参数:pag,col,hzk
 177          出口参数:
 178          *****************************************************************************/
 179          void Clr_Scr()
C51 COMPILER V9.00   DD                                                                    04/16/2015 18:28:55 PAGE 4   

 180          {
 181   1              unsigned char j,k;
 182   1              LCDMcs=0; //左、右屏均开显示
 183   1              LCDScs=0;
 184   1              write_com(Page_Add+0);
 185   1              write_com(LCDCol_Add+0);
 186   1              for(k=0;k<8;k++)//控制页数0-7，共8页
 187   1              {
 188   2                      write_com(Page_Add+k); //每页每页进行写
 189   2                      for(j=0;j<64;j++)  //每页最多可写32个中文文字或64个ASCII字符
 190   2                      {
 191   3                      write_com(LCDCol_Add+j);
 192   3                              write_data(0x00);//控制列数0-63，共64列，写点内容，列地址自动加1
 193   3                      }
 194   2              }
 195   1      }
 196          /*****************************************************************************
 197          函数功能:左屏位置显示
 198          入口参数:page,column,hzk
 199          出口参数:
 200          *****************************************************************************/
 201          void Bmp_Left_Disp(unsigned char page,unsigned char column, unsigned char code *Bmp)
 202          {
 203   1              unsigned char j=0,i=0;
 204   1              for(j=0;j<8;j++)
 205   1              {
 206   2                      write_com(Page_Add+page+j);
 207   2                      write_com(LCDCol_Add+column);
 208   2                      for(i=0;i<64;i++) 
 209   2                              write_data(Bmp[128*j+i]);
 210   2              }
 211   1      }
 212          /*****************************************************************************
 213          函数功能:右屏位置显示
 214          入口参数:page,column,hzk
 215          出口参数:
 216          *****************************************************************************/
 217          void Bmp_Right_Disp(unsigned char page,unsigned char column, unsigned char code *Bmp)
 218          {
 219   1              unsigned char j=0,i=0;
 220   1              for(j=0;j<8;j++)
 221   1              {
 222   2                      write_com(Page_Add+page+j);
 223   2                      write_com(LCDCol_Add+column);
 224   2                      for(i=64;i<128;i++) 
 225   2                              write_data(Bmp[128*j+i]);
 226   2              }
 227   1      }
 228          
 229          void main()
 230          {
 231   1              init_lcd();
 232   1              Clr_Scr();
 233   1              LCDMcs=0; //左屏开显示
 234   1              LCDScs=1;
 235   1          Bmp_Left_Disp(0,0,Hz);
 236   1          LCDMcs=1; //右屏开显示
 237   1              LCDScs=0;
 238   1              Bmp_Right_Disp(0,0,Hz);
 239   1      
 240   1              while(1)
 241   1          {
C51 COMPILER V9.00   DD                                                                    04/16/2015 18:28:55 PAGE 5   

 242   2        
 243   2              }
 244   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    376    ----
   CONSTANT SIZE    =   1024    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
